/* =========================================================================
   1. Variáveis, Reset e Configurações Globais
   ========================================================================= */

:root {
    /* Tokens — Duolingo claro (verde/azul) */
    --cor-primaria: #34D399;        /* Verde suave (CTA / progresso) */
    --cor-primaria-escura: #16A34A; /* Verde escuro (hover) */
    --cor-secundaria: #3B82F6;      /* Azul (info / links) */
    --cor-sucesso: #22C55E;         /* Verde sucesso */
    --cor-erro: #EF4444;            /* Vermelho erro */
    --cor-incentivo: #F59E0B;       /* Dourado (badges) */

    --cor-fundo-claro: #F6F7FB;     /* Fundo app */
    --cor-card-claro: #FFFFFF;      /* Cards */
    --cor-texto-principal: #111827; /* Texto */
    --cor-texto-muted: #6B7280;     /* Texto secundário */
    --cor-borda-clara: #E5E7EB;     /* Borda */

    /* Escala de texto (A+ / A-) */
    --text-scale: 1;

    /* Espaçamento e formas */
    --espacamento-padrao: 15px;
    --raio: 16px;
    --sombra-card: 0 8px 20px rgba(17, 24, 39, 0.08);
}

/* Modo Escuro (Dark Mode) */
body.dark-mode {
    --cor-primaria: #34D399;
    --cor-primaria-escura: #22C55E;
    --cor-secundaria: #60A5FA;
    --cor-sucesso: #22C55E;
    --cor-erro: #F87171;
    --cor-incentivo: #FBBF24;

    --cor-fundo-claro: #0B1220;
    --cor-card-claro: #111A2D;
    --cor-texto-principal: #E5E7EB;
    --cor-texto-muted: #9CA3AF;
    --cor-borda-clara: rgba(229,231,235,0.15);
}

* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    
    font-size: calc(16px * var(--text-scale));
font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, 'Apple Color Emoji','Segoe UI Emoji';
    background-color: var(--cor-fundo-claro);
    color: var(--cor-texto-principal);
    transition: background-color 0.3s, color 0.3s;
    min-height: 100vh;
    display: block;
    padding: 0;
}

.container {
    width: 100%;
    max-width: none;
    min-height: 100vh;
    padding: var(--espacamento-padrao);
}


/* =========================================================================
   2. Estilos de Telas e Navegação (Screen Management)
   ========================================================================= */

.screen {
    /* telas em tela cheia (evita “página dividida”) */
    background: transparent;
    padding: 0;
    border-radius: 0;
    box-shadow: none;
    transition: opacity 0.2s ease-in-out;
    display: none; /* inicia ocultas */
}

.screen.active {
    display: block;
    min-height: 100vh;
}

/* =========================================================================
   3. Estilos de Componentes Comuns (Botões, Cards, Header)
   ========================================================================= */

header {
    text-align: center;
    margin-bottom: 20px;
}

#main-logo {
    max-width: 220px;
    height: auto;
    margin-bottom: 10px;
}

/* PET Hero (Ferreirinha + Zezinho) — efeitos leves, sem pesar */
.pet-hero{position:relative;display:inline-block;}
.pet-hero::before{
    content:"";
    position:absolute;
    inset:-10px;
    background: radial-gradient(circle at 25% 40%, rgba(255,20,147,0.20), transparent 55%),
                radial-gradient(circle at 75% 45%, rgba(59,130,246,0.18), transparent 55%);
    filter: blur(6px);
    z-index:0;
    border-radius:28px;
    pointer-events:none;
}
.pet-hero img{position:relative;z-index:1;border-radius:22px;}
.pet-spark{position:absolute;z-index:2;font-size:18px;opacity:.9;pointer-events:none;animation:petFloat 2.8s ease-in-out infinite;}
.pet-spark.s1{left:-6px;top:14px;animation-delay:.1s;}
.pet-spark.s2{right:-8px;top:24px;animation-delay:.6s;}
.pet-spark.s3{left:50%;bottom:-10px;transform:translateX(-50%);animation-delay:1.1s;}
@keyframes petFloat{0%,100%{transform:translateY(0) rotate(0deg);}50%{transform:translateY(-8px) rotate(8deg);}}

.info-card {
    background-color: var(--cor-fundo-claro);
    border: 1px solid var(--cor-borda-clara);
    padding: var(--espacamento-padrao);
    border-radius: 8px;
    margin-bottom: 20px;
}

.centered-title {
    text-align: center;
    color: var(--cor-primaria);
    margin-bottom: 10px;
}

/* Botões Principais */
.main-btn, .btn-primary {
    display: block;
    width: 100%;
    padding: 12px;
    margin: 15px 0;
    background-color: var(--cor-primaria);
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 1.1em;
    font-weight: 700;
    cursor: pointer;
    transition: background-color 0.2s, transform 0.1s;
}

.main-btn:hover, .btn-primary:hover {
    background-color: #0056b3;
    transform: translateY(-1px);
}

.btn-secondary {
    background-color: var(--cor-borda-clara);
    color: var(--cor-texto-principal);
    padding: 8px 15px;
    border: 1px solid var(--cor-borda-clara);
    border-radius: 6px;
    cursor: pointer;
    transition: background-color 0.2s;
}

.btn-secondary:hover {
    background-color: #e9ecef;
}

/* =========================================================================
   4. Estilos da Tela Inicial (home-screen)
   ========================================================================= */

.call-to-action-paragraph {
    text-align: center;
    font-size: 1.1em;
    font-weight: 600;
    margin-bottom: 20px;
    color: var(--cor-secundaria);
}

.operation-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr); /* 3 colunas */
    gap: 10px;
    margin-bottom: 25px;
}

.operation-card {
    background-color: var(--cor-fundo-claro);
    border: 2px solid var(--cor-primaria);
    color: var(--cor-texto-principal);
    padding: 15px 10px;
    border-radius: 8px;
    cursor: pointer;
    transition: background-color 0.2s, transform 0.1s, box-shadow 0.2s;
    text-align: center;
}

.operation-card h3 {
    margin: 0;
    font-size: 1em;
}

.operation-card:hover {
    background-color: var(--cor-primaria);
    color: white;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 123, 255, 0.4);
}

/* Barra de Configurações (Dark Mode / Modo Jogo) */
.settings-bar, .accessibility-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
    padding: 10px 0;
    border-top: 1px solid var(--cor-borda-clara);
}

.accessibility-bar {
    border-bottom: 1px solid var(--cor-borda-clara);
}

.access-title {
    font-weight: 600;
}

.setting-btn, .mode-btn {
    background: none;
    border: 1px solid var(--cor-borda-clara);
    color: var(--cor-texto-principal);
    padding: 5px 10px;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.2s;
    font-size: 0.9em;
}

.setting-btn:hover, .mode-btn:hover {
    background-color: var(--cor-fundo-claro);
}

.setting-btn.active {
    background-color: var(--cor-incentivo);
    color: var(--cor-texto-principal);
    border-color: var(--cor-incentivo);
}

.mode-btn.active {
    background-color: var(--cor-secundaria);
    color: white;
    border-color: var(--cor-secundaria);
}

.modes-toggle {
    display: flex;
    gap: 5px;
    align-items: center;
}

/* =========================================================================
   5. Estilos da Tela de Nível e Jogo
   ========================================================================= */

/* Estilos de Nível */
.level-selection {
    display: flex;
    justify-content: space-between;
    gap: 15px;
    margin-top: 20px;
}

.level-btn {
    flex-grow: 1;
    background-color: var(--cor-fundo-claro);
    border: 2px solid var(--cor-primaria);
    color: var(--cor-texto-principal);
    padding: 20px 10px;
    border-radius: 10px;
    cursor: pointer;
    text-align: center;
    transition: transform 0.1s, box-shadow 0.2s;
}

.level-btn h3 { margin-bottom: 5px; color: var(--cor-primaria); }
.level-btn p { font-size: 0.85em; }

.level-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 123, 255, 0.4);
}


/* Estilos de Game Screen */
.game-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 25px;
}

.score-info {
    font-weight: 700;
    text-align: right;
}

.time-container {
    height: 10px;
    background-color: var(--cor-borda-clara);
    border-radius: 5px;
    margin-bottom: 20px;
    overflow: hidden;
}

#time-bar {
    height: 100%;
    transition: width 0.1s linear, background-color 0.5s;
}

.question-area {
    text-align: center;
    padding: 30px 20px;
}

#question-counter {
    color: var(--cor-secundaria);
    font-weight: 600;
    margin-bottom: 10px;
}

#question-text {
    font-size: 2.5em;
    margin: 0;
    color: var(--cor-texto-principal);
}

.answers-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 15px;
    margin-top: 20px;
}

.btn-answer {
    background-color: var(--cor-fundo-claro);
    border: 1px solid var(--cor-borda-clara);
    padding: 20px;
    font-size: 1.2em;
    font-weight: 700;
    border-radius: 8px;
    cursor: pointer;
    transition: background-color 0.2s, transform 0.1s;
    color: var(--cor-texto-principal);
}

.btn-answer:hover:not(:disabled) {
    background-color: #e9ecef;
}

.btn-answer.correct {
    background-color: var(--cor-sucesso);
    color: white;
    border-color: var(--cor-sucesso);
}

.btn-answer.wrong {
    background-color: var(--cor-erro);
    color: white;
    border-color: var(--cor-erro);
}

/* Botões de Ação do Jogo (Estender Tempo / Ajuda) */
.action-buttons {
    display: flex;
    justify-content: center;
    gap: 15px;
    margin-top: 25px;
}

.btn-action {
    background-color: var(--cor-incentivo);
    color: var(--cor-texto-principal);
    border: none;
    padding: 10px 15px;
    border-radius: 6px;
    cursor: pointer;
    font-weight: 600;
    transition: opacity 0.2s;
}

.btn-action:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}


/* =========================================================================
   6. Estilos de Feedback, Alertas e Resultados
   ========================================================================= */

.feedback-message {
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    padding: 15px 30px;
    border-radius: 8px;
    color: white;
    font-weight: 600;
    z-index: 1000;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s, visibility 0.3s;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}

.feedback-message.show {
    opacity: 1;
    visibility: visible;
}

.feedback-message.success { background-color: var(--cor-sucesso); }
.feedback-message.warning { background-color: var(--cor-secundaria); }
.feedback-message.error { background-color: var(--cor-erro); }
.feedback-message.info { background-color: var(--cor-primaria); }
.feedback-message.incentive { background-color: var(--cor-incentivo); color: var(--cor-texto-principal); }


.libras-alert {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: rgba(var(--cor-secundaria), 0.95);
    color: white;
    padding: 20px 40px;
    border-radius: 10px;
    font-size: 1.5em;
    font-weight: 700;
    z-index: 999;
    box-shadow: 0 0 20px rgba(255, 78, 80, 0.7);
    animation: pulse 1s infinite alternate;
}

.libras-alert.hidden {
    display: none;
}

@keyframes pulse {
    from { transform: translate(-50%, -50%) scale(1); opacity: 0.95; }
    to { transform: translate(-50%, -50%) scale(1.05); opacity: 1; }
}


/* Estilos de Resultados */
.result-summary {
    text-align: center;
    margin-bottom: 25px;
    padding: 25px;
}

.result-details {
    display: flex;
    justify-content: space-around;
    margin-top: 20px;
    padding-top: 15px;
    border-top: 1px dashed var(--cor-borda-clara);
}

.result-item {
    text-align: center;
}

.stat-label {
    font-weight: 600;
    color: var(--cor-texto-principal);
}

.result-item p {
    font-size: 1.8em;
    font-weight: 900;
    margin: 5px 0 0 0;
}

.footer-options {
    display: flex;
    gap: 10px;
}

/* Estilos de Ranking e Erros */
.ranking-list-container, .error-list-container {
    margin-top: 20px;
}

.ranking-item, .error-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
    padding: 15px;
    background-color: var(--cor-fundo-claro);
    border-left: 5px solid var(--cor-primaria);
    border-radius: 6px;
}

.error-item {
     border-left: 5px solid var(--cor-erro);
     flex-direction: column;
     align-items: flex-start;
     gap: 5px;
}

.wrong-answer { color: var(--cor-erro); font-weight: 600; }
.correct-answer { color: var(--cor-sucesso); font-weight: 600; }

.ranking-item h3 { margin: 0; }
.ranking-item p { margin: 0; font-size: 0.9em; }

/* =========================================================================
   8. Estilos da Seção "Criadores" (Avatares menores e circulares)
   ========================================================================= */

#creators-section {
    margin-top: 30px;
    padding-top: 20px;
    border-top: 1px solid var(--cor-borda-clara);
    text-align: center;
}

.creators-grid {
    display: flex;
    justify-content: center;
    gap: 30px; 
    margin-top: 15px;
}

.creator-card {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 120px;
}

/* Tamanho do Avatar (Ajuste principal) */
.creator-card .avatar {
    width: 80px;      /* Largura do avatar */
    height: 80px;     /* Altura do avatar */
    border-radius: 50%; /* Transforma em círculo */
    object-fit: contain;
    object-position: center;
 
    border: 3px solid var(--cor-primaria); /* Borda para destaque */
    margin-bottom: 5px;
  background: rgba(255,255,255,0.9);
}

.creator-card p {
    font-size: 0.9em;
    font-weight: 600;
    margin: 5px 0 0 0;
    color: var(--cor-texto-principal);
}

/* =========================================================================
   9. Responsividade
   ========================================================================= */

@media (max-width: 480px) {
    .container {
        padding: 0;
        margin-top: 0;
    }

    .screen {
        padding: var(--espacamento-padrao);
        border-radius: 0;
        box-shadow: none;
    }

    .operation-grid {
        grid-template-columns: 1fr 1fr; /* 2 colunas em telas pequenas */
    }
    
    .level-selection {
        flex-direction: column;
        gap: 10px;
    }
    
    #question-text {
        font-size: 1.8em;
    }

    .answers-grid {
        grid-template-columns: 1fr;
    }
    
    .setting-btn, .mode-btn {
        padding: 8px;
    }

    /* Avatares menores em telas muito pequenas */
    .creators-grid {
        gap: 15px;
    }
    .creator-card .avatar {
        width: 60px;
        height: 60px;
    }
    .creator-card p {
        font-size: 0.8em;
    }
    
    .action-buttons {
        flex-direction: column;
    }
}

/* --- Melhorias: alternativas numeradas + modal da tabuada --- */
.answer-option{
    display:flex;
    align-items:center;
    justify-content:flex-start;
    gap: 10px;
}
.answer-index{
    font-size: 0.85em;
    font-weight: 700;
    opacity: 0.85;
    min-width: 28px;
}
.answer-text{
    font-weight: 800;
}

/* Modal (Multiplicação) */
/* Modal (Multiplicação) — FULLSCREEN */
.mm-modal-overlay{
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.65);
    display:flex;
    align-items:stretch;
    justify-content:stretch;
    padding: 0;
    z-index: 9999;
}
.mm-modal-overlay.hidden{ display:none; }

.mm-modal{
    width: 100%;
    height: 100%;
    background: var(--cor-fundo, #fff);
    color: var(--cor-texto, #111);
    border-radius: 0;
    box-shadow: none;
    padding: 18px 18px 22px;
    border: none;
    overflow: auto;
}
.mm-modal-header{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap: 10px;
}
.mm-modal-header h2{
    font-size: 1.15rem;
    margin: 0;
}
.mm-close{
    border: none;
    background: transparent;
    font-size: 1.1rem;
    cursor:pointer;
    padding: 8px 10px;
    border-radius: 10px;
}
.mm-close:hover{ background: rgba(0,0,0,0.06); }
.mm-sub{ margin: 8px 0 12px; opacity: .9; }
.mm-sub2{ margin: 14px 0 8px; opacity: .9; }

.mm-actions{
    display:flex;
    flex-direction:column;
    gap: 10px;
}
.mm-btn{
    border-radius: 14px;
    padding: 12px 14px;
    border: 1px solid rgba(0,0,0,0.12);
    background: rgba(255,255,255,0.9);
    cursor:pointer;
    font-weight: 800;
    text-align:left;
}
.mm-btn:hover{ transform: translateY(-1px); }
.mm-primary{
    background: var(--cor-sucesso);
    color: #0b1a00;
    border-color: rgba(0,0,0,0.15);
}
.mm-direct.hidden{ display:none; }

/* =========================================================================
   Badge flutuante: Progresso do ciclo (Tabuada)
   ========================================================================= */

.mm-cycle-progress {
    position: fixed;
    top: 12px;
    right: 12px;
    z-index: 9999;
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 8px 12px;
    border-radius: 999px;
    background: rgba(255, 255, 255, 0.92);
    color: var(--cor-texto-principal);
    border: 1px solid rgba(0, 0, 0, 0.08);
    box-shadow: 0 6px 18px rgba(0, 0, 0, 0.08);
    font-weight: 700;
    font-size: 12px;
    letter-spacing: 0.2px;
}

body.dark-mode .mm-cycle-progress {
    background: rgba(30, 30, 30, 0.92);
    border-color: rgba(255, 255, 255, 0.12);
    box-shadow: 0 6px 18px rgba(0, 0, 0, 0.35);
}

.mm-grid{
    display:grid;
    grid-template-columns: repeat(7, minmax(0, 1fr));
    gap: 8px;
}
.mm-grid-btn{
    border-radius: 12px;
    padding: 10px 0;
    border: 1px solid rgba(0,0,0,0.12);
    background: rgba(255,255,255,0.95);
    cursor:pointer;
    font-weight: 900;
}
.mm-grid-btn:hover{ transform: translateY(-1px); }
.mm-footer{ margin-top: 12px; opacity: .85; }



/* --- Ranking --- */
.ranking-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  padding: 12px 14px;
  margin: 10px 0;
  border-radius: 14px;
  background: rgba(255,255,255,0.08);
  border: 1px solid rgba(255,255,255,0.12);
}
.ranking-left { flex: 1; min-width: 0; }
.ranking-title { font-size: 0.98em; line-height: 1.2; }
.ranking-meta { font-size: 0.85em; opacity: 0.85; margin-top: 4px; }
.ranking-score { font-size: 1.2em; font-weight: 800; }

/* --- Painel do Professor --- */
.teacher-fab {
  position: fixed;
  right: 16px;
  bottom: 16px;
  z-index: 9999;
  width: 52px;
  height: 52px;
  border-radius: 999px;
  border: 1px solid rgba(0,0,0,0.15);
  box-shadow: 0 10px 30px rgba(0,0,0,0.25);
  cursor: pointer;
  font-size: 22px;
}
.teacher-overlay {
  position: fixed;
  inset: 0;
  z-index: 9998;
  background: rgba(0,0,0,0.55);
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 16px;
}
.teacher-overlay.hidden { display: none; }

.teacher-panel {
  width: min(560px, 95vw);
  border-radius: 18px;
  padding: 16px;
  background: #ffffff;
  border: 1px solid rgba(17, 24, 39, 0.12);
  box-shadow: 0 20px 60px rgba(0,0,0,0.35);
  color: #000000;
}
.teacher-panel-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  margin-bottom: 12px;
}
.teacher-panel-section { margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(255,255,255,0.12); }
.teacher-row { display: flex; gap: 10px; flex-wrap: wrap; }
.teacher-help { font-size: 0.9em; opacity: 0.9; margin-top: 8px; }

/* --- Projeção (Datashow) --- */
body.projection-mode {
  font-size: 18px;
}
body.projection-mode .btn-primary,
body.projection-mode .btn-secondary,
body.projection-mode .answer-option {
  font-size: 1.05em;
  padding: 16px 18px;
}
body.projection-mode #question-text {
  font-size: 2.1em;
}

/* --- Baixo estímulo --- */
body.low-stimulus * {
  animation: none !important;
  transition: none !important;
}
body.low-stimulus #confetti-container { display: none !important; }


/* =========================================================================
   11. Atualizações v13 — Visual clean (Duolingo-like), Trilha e Painel Professor claro
   ========================================================================= */

/* Painel do Professor (fundo claro, letras escuras) */
.teacher-overlay {
    backdrop-filter: blur(2px);
}
.teacher-panel {
    background: #ffffff;
    color: #000000;
    border: 1px solid rgba(17, 24, 39, 0.12);
}
.teacher-panel h2, .teacher-panel h3 {
    color: #000000;
}
.teacher-help {
    color: rgba(0,0,0,0.75);
}
.teacher-panel .btn-secondary,
.teacher-panel .btn-action.btn-secondary {
    background: rgba(17, 24, 39, 0.06);
    color: #000000;
    border: 1px solid rgba(17, 24, 39, 0.12);
}
.teacher-panel .btn-secondary:hover,
.teacher-panel .btn-action.btn-secondary:hover {
    background: rgba(17, 24, 39, 0.10);
}
.teacher-panel .btn-action {
    border: 1px solid rgba(17, 24, 39, 0.12);
}
.teacher-guide summary {
    cursor: pointer;
    font-weight: 700;
    margin-bottom: 8px;
}
.teacher-guide ul {
    padding-left: 18px;
    margin: 10px 0 0;
}
.teacher-guide li {
    margin: 6px 0;
}

/* Perfil do estudante (modal reaproveitando painel) */
.profile-panel .tp-input {
    width: 100%;
    padding: 10px 12px;
    border-radius: 10px;
    border: 1px solid rgba(17, 24, 39, 0.18);
    background: #fff;
    color: #111827;
}
.profile-panel .tp-label {
    display: block;
    font-weight: 700;
    margin-top: 10px;
    margin-bottom: 6px;
    color: rgba(17, 24, 39, 0.85);
}

/* Trilha (mapa) */
.map-card {
    margin-top: 14px;
}
.map-header h2 {
    margin: 0;
}
.map-sub {
    margin: 6px 0 0;
    opacity: 0.85;
}
.map-rows {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-top: 12px;
}
.map-row {
    display: grid;
    grid-template-columns: 90px 1fr 70px;
    align-items: center;
    gap: 10px;
    padding: 10px 12px;
    border-radius: 14px;
    border: 1px solid rgba(255,255,255,0.10);
    background: rgba(255,255,255,0.06);
    cursor: pointer;
}
body:not(.dark-mode) .map-row {
    border: 1px solid rgba(17,24,39,0.10);
    background: rgba(17,24,39,0.02);
}
.map-label {
    font-weight: 800;
}
.map-meta {
    text-align: right;
    font-weight: 800;
    opacity: 0.8;
}
.map-nodes {
    display: flex;
    align-items: center;
    gap: 8px;
}
.map-node {
    width: 14px;
    height: 14px;
    border-radius: 999px;
    border: 2px solid rgba(255,255,255,0.35);
    opacity: 0.75;
}
body:not(.dark-mode) .map-node {
    border-color: rgba(17,24,39,0.25);
}
.map-node.done {
    background: var(--cor-sucesso);
    border-color: var(--cor-sucesso);
    opacity: 1;
}
.map-node.current {
    border-color: var(--cor-incentivo);
    opacity: 1;
    transform: scale(1.06);
}

/* Ajuste: botão Perfil alinhado */
#btn-student-profile .icon {
    margin-right: 6px;
}


/* Teacher panel forced light */
.teacher-panel { background: #ffffff !important; color: #000000 !important; }
.teacher-panel * { color: inherit; }


/* =========================
   Melhorias (A11Y, atalhos, toolbar, relatórios)
   ========================= */
.mm-row{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  align-items:center;
}

.link-btn{
  text-decoration:none;
  display:inline-flex;
  align-items:center;
  justify-content:center;
}

.game-toolbar{
  display:flex;
  justify-content:space-between;
  gap:10px;
  flex-wrap:wrap;
  margin:10px 0 0;
}

.accessibility-controls{
  display:flex;
  gap:8px;
  flex-wrap:wrap;
  justify-content:flex-end;
}

.hint-panel{
  margin-top:12px;
}

.hint-panel.hidden{
  display:none;
}




/* =========================================================================
   REDESIGN v16 — Home, Campanha, Bottom Nav, Mentor Bubble
   ========================================================================= */

.container{
    padding-bottom: 78px; /* espaço para bottom-nav */
}

.home-header{
    display:flex;
    align-items:center;
    justify-content:center;
    padding: 18px 10px 6px;
}

#main-logo{
    max-width: 520px;
    width: min(92vw, 520px);
    height:auto;
    border-radius: var(--raio);
    box-shadow: var(--sombra-card);
}

.section{
    margin-top: 14px;
}

.section-head{
    padding: 0 4px;
    margin: 6px 0 10px;
}

.section-title{
    font-size: 1.05rem;
    font-weight: 800;
    margin: 0;
}

.section-sub{
    margin: 3px 0 0;
    color: var(--cor-texto-muted);
    font-weight: 600;
}

.hero-card{
    margin-top: 14px;
}

.hero-row{
    display:flex;
    gap: 12px;
    align-items:center;
    justify-content:space-between;
    flex-wrap: wrap;
}

.hero-title{
    margin: 0;
    font-size: 1.15rem;
    font-weight: 900;
}

.hero-sub{
    margin: 4px 0 0;
    color: var(--cor-texto-muted);
    font-weight: 600;
}

.cta-btn{
    background: var(--cor-primaria);
    border: none;
}
.cta-btn:hover{ background: var(--cor-primaria-escura); }

.daily-goal{
    margin-top: 12px;
    padding-top: 10px;
    border-top: 1px solid var(--cor-borda-clara);
}
.daily-row{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap: 10px;
    flex-wrap: wrap;
}
.daily-text{ font-weight: 800; }

.pill{
    display:inline-block;
    padding: 4px 10px;
    border-radius: 999px;
    background: rgba(17,24,39,0.06);
    font-weight: 900;
}

.bar{
    margin-top: 8px;
    height: 10px;
    border-radius: 999px;
    background: rgba(17,24,39,0.08);
    overflow:hidden;
}
.bar-fill{
    height: 100%;
    width: 0%;
    border-radius: 999px;
    background: var(--cor-primaria);
    transition: width 250ms ease;
}

.quick-actions{
    display:grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 10px;
    margin-top: 12px;
}
@media(max-width:520px){
    .quick-actions{ grid-template-columns: 1fr; }
}

.quick-btn{
    border: 1px solid var(--cor-borda-clara);
    background: var(--cor-card-claro);
    border-radius: var(--raio);
    padding: 12px 12px;
    font-weight: 900;
    box-shadow: var(--sombra-card);
    cursor:pointer;
}
.quick-btn:hover{
    border-color: rgba(59,130,246,0.35);
}

.tabs{
    display:flex;
    gap: 10px;
    flex-wrap: wrap;
}
.tab-btn{
    border: 1px solid var(--cor-borda-clara);
    background: var(--cor-card-claro);
    border-radius: 999px;
    padding: 10px 14px;
    font-weight: 900;
    cursor: pointer;
}
.tab-btn.active{
    border-color: rgba(52,211,153,0.65);
    box-shadow: 0 0 0 4px rgba(52,211,153,0.18);
}

.muted{ color: var(--cor-texto-muted); }

.about-details summary{
    cursor:pointer;
    font-weight: 900;
    margin: 10px 0;
    list-style:none;
}
.about-details summary::-webkit-details-marker{ display:none; }
.about-card{ margin-top: 10px; }

.ui-prefs{
    display:flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-bottom: 10px;
}

.bottom-nav{
    position: fixed;
    left: 0;
    right: 0;
    bottom: 0;
    height: 66px;
    background: rgba(255,255,255,0.9);
    backdrop-filter: blur(6px);
    border-top: 1px solid var(--cor-borda-clara);
    display:flex;
    align-items:center;
    justify-content:space-around;
    padding: 8px 10px;
    z-index: 999;
}
body.dark-mode .bottom-nav{
    background: rgba(17,26,45,0.92);
}

.nav-item{
    border: none;
    background: transparent;
    display:flex;
    flex-direction:column;
    gap: 2px;
    align-items:center;
    justify-content:center;
    font-weight: 800;
    color: var(--cor-texto-muted);
    cursor:pointer;
    min-width: 68px;
}
.nav-item.active{
    color: var(--cor-secundaria);
}
.nav-ico{ font-size: 18px; line-height: 1; }
.nav-txt{ font-size: 12px; line-height: 1; }

.campaign-map{
    display:flex;
    flex-direction:column;
    gap: 12px;
    padding: 0 4px 18px;
}
.unit-card{
    border: 1px solid var(--cor-borda-clara);
    background: var(--cor-card-claro);
    border-radius: var(--raio);
    padding: 14px;
    box-shadow: var(--sombra-card);
}
.unit-head{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap: 10px;
}
.unit-title{
    font-weight: 900;
    margin: 0;
}
.unit-sub{
    margin: 4px 0 0;
    color: var(--cor-texto-muted);
    font-weight: 600;
}
.lesson-row{
    display:flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-top: 12px;
}
.lesson-node{
    border: 1px solid var(--cor-borda-clara);
    background: var(--cor-fundo-claro);
    border-radius: 999px;
    padding: 10px 12px;
    font-weight: 900;
    cursor:pointer;
}
.lesson-node.done{
    background: rgba(34,197,94,0.12);
    border-color: rgba(34,197,94,0.35);
}
.lesson-node.current{
    background: rgba(59,130,246,0.12);
    border-color: rgba(59,130,246,0.35);
}

.mentor-float{
    position: absolute;
    top: 76px;
    right: 12px;
    left: auto;
    display:flex;
    gap: 10px;
    align-items:flex-start;
    z-index: 10;
}
#game-screen{ position: relative; }
.mentor-avatar{
    width: 44px;
    height: 44px;
    border-radius: 999px;
    border: 2px solid rgba(255,255,255,0.9);
    background: var(--cor-card-claro);
    object-fit: contain;
    box-shadow: var(--sombra-card);
}
.mentor-bubble{
    max-width: min(66vw, 360px);
    padding: 10px 12px;
    border-radius: var(--raio);
    background: var(--cor-card-claro);
    border: 1px solid var(--cor-borda-clara);
    box-shadow: var(--sombra-card);
    font-weight: 800;
    color: var(--cor-texto-principal);
}
.mentor-bubble::before{
    content:"";
    position:absolute;
    width: 0; height: 0;
    border-top: 10px solid transparent;
    border-bottom: 10px solid transparent;
    border-right: 12px solid var(--cor-card-claro);
    left: 52px;
    top: 16px;
}

.hidden{ display:none !important; }

/* Acessibilidade — alto contraste / reduzir movimento */
body.high-contrast{
    --cor-fundo-claro: #FFFFFF;
    --cor-card-claro: #FFFFFF;
    --cor-texto-principal: #000000;
    --cor-texto-muted: #111827;
    --cor-borda-clara: #000000;
}
body.reduce-motion *{
    transition: none !important;
    animation: none !important;
}


/* Layout forçado (professor pode escolher) */
body.force-desktop .container{ max-width: 980px; }
body.force-mobile .container{ max-width: 520px; }
body.force-mobile .quick-actions{ grid-template-columns: 1fr !important; }


/* === v17 Learning Tools UI === */
.game-tools{
  display:flex; gap:10px; align-items:center; justify-content:center;
  margin:12px auto 6px; flex-wrap:wrap;
}
.tool-btn{
  border:1px solid var(--cor-borda, #E5E7EB);
  background: var(--cor-card, #fff);
  color: var(--cor-texto, #111827);
  border-radius: 999px;
  padding: 10px 14px;
  font-weight: 700;
  cursor:pointer;
  box-shadow: var(--sombra-card, 0 6px 16px rgba(17,24,39,.08));
}
.tool-btn:active{ transform: translateY(1px); }
.hint-panel{
  max-width: 560px;
  margin: 10px auto;
  background: var(--cor-card, #fff);
  border: 1px solid var(--cor-borda, #E5E7EB);
  border-radius: 16px;
  padding: 12px;
  box-shadow: var(--sombra-card, 0 10px 22px rgba(17,24,39,.10));
}
.hint-head{ display:flex; align-items:center; justify-content:space-between; gap:12px; }
.hint-title{ font-weight: 800; }
.hint-close{
  border:none; background:transparent; cursor:pointer;
  font-size: 18px; line-height: 1;
  padding: 6px 10px; border-radius: 10px;
}
.hint-body{ margin: 10px 0 12px; color: var(--cor-texto, #111827); }
.hint-next{ width:100%; }
.typed-area{
  max-width: 560px;
  margin: 8px auto 10px;
  display:flex; gap:10px; align-items:center; justify-content:center;
}
.typed-input{
  flex:1;
  border:1px solid var(--cor-borda, #E5E7EB);
  border-radius: 14px;
  padding: 12px 14px;
  font-size: 18px;
}
.typed-submit{ min-width: 140px; }
.modal-overlay{
  position: fixed; inset: 0;
  display:flex; align-items:center; justify-content:center;
  background: rgba(17,24,39,.45);
  padding: 18px;
  z-index: 9999;
}
.modal-card{
  background: var(--cor-card, #fff);
  border: 1px solid var(--cor-borda, #E5E7EB);
  border-radius: 18px;
  max-width: 520px;
  width: 100%;
  padding: 16px;
  box-shadow: 0 18px 36px rgba(0,0,0,.18);
}
.modal-title{ margin:0 0 6px; }
.modal-text{ margin: 0 0 14px; }
.modal-actions{ display:flex; gap:10px; justify-content:flex-end; flex-wrap:wrap; }
.hidden{ display:none !important; }


/* ===== v18 — Missões de 5 minutos ===== */
.missions-card{ margin-top: 12px; }
.missions-head{ display:flex; align-items:center; justify-content:space-between; gap:10px; }
.missions-title{ margin:0; font-size:1.05em; }
.missions-grid{ display:grid; grid-template-columns:1fr; gap:10px; margin-top:10px; }
@media(min-width:720px){ .missions-grid{ grid-template-columns: repeat(3, 1fr); } }
.mission-btn{
  border: 1px solid var(--cor-borda-clara);
  background: var(--cor-card-claro);
  padding: 12px 12px;
  border-radius: 18px;
  font-weight: 900;
  cursor: pointer;
  transition: transform .12s ease, opacity .12s ease;
  box-shadow: 0 10px 25px rgba(0,0,0,0.06);
}
.mission-btn:hover{ transform: translateY(-1px); }
.mission-btn:active{ transform: translateY(0px); }
.mission-btn:disabled{ cursor:not-allowed; opacity:.55; transform:none; }
.mission-btn.done{ opacity:.65; text-decoration: line-through; }



/* Acessibilidade v19: foco visível forte */
:focus{outline:none;}
:focus-visible{
  outline: 3px solid rgba(59,130,246,0.95);
  outline-offset: 3px;
}

/* Skip link */
.skip-link{position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden;}
.skip-link:focus{left:12px;top:12px;width:auto;height:auto;z-index:9999;padding:10px 12px;border-radius:14px;background:#fff;box-shadow:0 10px 30px rgba(0,0,0,.18);}


/* v19.1 — Teclado numérico (turma fraca) */

.typed-keypad{
  display: grid;
  grid-template-columns: repeat(4, minmax(0, 1fr));
  gap: 10px;
  margin-top: 12px;
}
.typed-keypad .kp{
  font-size: 18px;
  padding: 14px 10px;
  border-radius: 14px;
  border: 2px solid rgba(0,0,0,0.08);
  background: #ffffff;
  box-shadow: 0 2px 0 rgba(0,0,0,0.06);
  touch-action: manipulation;
  user-select: none;
}
.typed-keypad .kp:active{ transform: translateY(1px); }
.typed-keypad .kp-fn{ font-size: 14px; }
.typed-keypad .kp-ok{
  background: #1aa362;
  color: #fff;
  border-color: rgba(0,0,0,0.06);
  font-weight: 800;
}
.typed-keypad .kp-zero{
  grid-column: span 4;
  font-weight: 800;
}


/* --- Audit v20: foco visível + hierarquia CTA + onboarding --- */
:focus-visible { outline: 3px solid #000; outline-offset: 3px; }
body.high-contrast :focus-visible { outline: 3px solid #fff; }

.primary-cta{
  font-weight: 800 !important;
  transform: translateZ(0);
  box-shadow: 0 10px 22px rgba(0,0,0,.18);
  border-width: 2px !important;
}
.primary-cta:active{ transform: scale(0.99); }

.home-cta-stack{ display:flex; flex-direction:column; gap:12px; }
.home-cta-secondary{ opacity: .92; }

.onboarding-modal{
  position:fixed; inset:0; z-index:9999;
  display:flex; align-items:center; justify-content:center;
  background: rgba(0,0,0,.55);
  padding:16px;
}
.onboarding-card{
  width:min(560px, 96vw);
  background: var(--cor-card, #fff);
  color: var(--cor-texto, #111);
  border-radius: 16px;
  padding: 18px;
  box-shadow: 0 16px 40px rgba(0,0,0,.25);
}
.onboarding-steps{ display:flex; gap:8px; margin: 0 0 10px 0; }
.onboarding-dot{ width:10px; height:10px; border-radius:99px; background: rgba(0,0,0,.2); }
.onboarding-dot.active{ background: rgba(0,0,0,.8); }
.onboarding-title{ font-size: 1.15rem; font-weight:800; margin: 6px 0; }
.onboarding-text{ font-size: 1rem; line-height:1.35; margin: 6px 0 14px; }
.onboarding-actions{ display:flex; gap:10px; justify-content:flex-end; flex-wrap:wrap; }
.onboarding-actions button{ min-width: 120px; }


/* ===========================
   PET Story + Mode Picker
   =========================== */
.pet-story{
  margin: 10px 0 14px;
  padding: 14px 14px;
  border-radius: 16px;
  background: rgba(0,0,0,0.04);
}
.light-mode .pet-story{ background: rgba(0,0,0,0.04); }
.dark-mode .pet-story{ background: rgba(255,255,255,0.06); }

.pet-story-title{
  margin: 0 0 6px;
  font-size: 1.1rem;
  font-weight: 800;
}
.pet-story-text{
  margin: 0;
  line-height: 1.35;
  font-size: 0.95rem;
  opacity: 0.95;
}

.mode-picker{
  margin: 0 0 14px;
  padding: 12px 14px;
  border-radius: 16px;
  border: 1px solid rgba(0,0,0,0.08);
  background: rgba(255,255,255,0.7);
}
.dark-mode .mode-picker{ border-color: rgba(255,255,255,0.14); background: rgba(0,0,0,0.22); }
.mode-picker-row{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap: 10px;
  flex-wrap: wrap;
}
.mode-picker-title{ font-weight: 800; }
.mode-picker-buttons{
  display:flex;
  gap: 8px;
}
.mode-btn{
  padding: 10px 12px;
  border-radius: 14px;
  border: 1px solid rgba(0,0,0,0.14);
  background: rgba(255,255,255,0.9);
  cursor: pointer;
  font-weight: 800;
}
.dark-mode .mode-btn{ border-color: rgba(255,255,255,0.18); background: rgba(0,0,0,0.25); color: #fff; }
.mode-btn.active{
  outline: 3px solid rgba(52,211,153,0.45);
  border-color: rgba(22,163,74,0.65);
}
.mode-picker-hint{
  margin: 8px 0 0;
  font-size: 0.85rem;
  opacity: 0.85;
}

/* ===========================
   UI mode tweaks
   =========================== */
body.ui-pc .container{
  max-width: 980px;
}
body.ui-pc .quick-actions{
  grid-template-columns: 1fr;
}
body.ui-pc .answer-option{
  min-height: 56px;
  font-size: 1.05rem;
}

/* Onboarding: uma fase por tela (sem rolagem) */
#onboarding-modal .onb-card{
  max-height: 85vh;
  overflow: hidden;
}
#onboarding-modal .onb-body{
  overflow: hidden;
}


/* ===========================
   Onboarding modal
   =========================== */
.onb-overlay{
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.55);
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 16px;
  z-index: 10000;
}
.onb-overlay.hidden{ display:none; }
.onb-card{
  width: min(520px, 96vw);
  background: var(--cor-fundo, #fff);
  color: var(--cor-texto, #111);
  border-radius: 18px;
  padding: 16px;
  box-shadow: 0 12px 30px rgba(0,0,0,0.25);
  display:flex;
  flex-direction: column;
  gap: 10px;
}
.onb-header h2{ margin:0; font-size:1.15rem; }
.onb-body{ flex: 1; display:flex; align-items:center; }
.onb-body p{ margin:0; font-size:1rem; line-height:1.35; }
.onb-dots{ display:flex; justify-content:center; gap:8px; }
.onb-dot{
  width: 10px; height:10px; border-radius: 999px;
  background: rgba(0,0,0,0.18);
}
.dark-mode .onb-dot{ background: rgba(255,255,255,0.25); }
.onb-dot.active{ background: var(--cor-primaria, #34D399); }
.onb-actions{ display:flex; justify-content: space-between; gap:10px; }
.onb-btn{
  border-radius: 14px;
  padding: 10px 14px;
  font-weight: 800;
  cursor: pointer;
  border: 1px solid rgba(0,0,0,0.14);
  background: rgba(255,255,255,0.9);
}
.dark-mode .onb-btn{ border-color: rgba(255,255,255,0.18); background: rgba(0,0,0,0.25); color:#fff; }
.onb-next{
  background: var(--cor-primaria, #34D399);
  border-color: rgba(22,163,74,0.65);
  color: #04210f;
}


/* PET Story */
.pet-story{max-width: 980px; margin: 14px auto 0; padding: 0 14px 10px; text-align:left;}
.pet-story-title{font-size:1.35rem; margin:10px 0 6px;}
.pet-story-subtitle{margin:0 0 10px; opacity:0.9; font-weight:600;}
.pet-story-h2{font-size:1.05rem; margin:14px 0 6px;}
.pet-story-list{margin:8px 0 0 18px;}

/* Fullscreen pickers — botões grandes */
.level-selection{display:grid; gap:12px;}
.level-selection .level-btn{padding:18px 16px; border-radius:16px;}
.level-selection .level-btn h3{font-size:1.25rem; margin:0 0 6px;}
.level-selection .level-btn p{margin:0; font-size:1rem; opacity:0.9;}

.mm-actions{gap:12px;}
.mm-btn{padding:16px 14px; font-size:1.05rem; border-radius:16px;}
.mm-grid-btn{padding:16px 0; font-size:1.05rem; border-radius:14px;}


/* Telas de seleção em tela cheia (operações/níveis) */
#level-selection-screen.active,
#home-screen.active,
#campaign-screen.active{
    min-height: 100vh;
    border-radius: 0;
    box-shadow: none;
}
#level-selection-screen .level-selection .level-btn{
    padding: 18px 16px;
    border-radius: 18px;
}
#level-selection-screen h1{font-size: 1.6rem;}
#level-selection-screen .op-subtitle{margin-top:6px;}

/* Melhor clique/touch */
button, .main-btn, .level-btn, .op-btn, .tool-btn, .mm-btn{touch-action: manipulation;}


/* Fullscreen selectors */
#level-selection-screen .level-selection{display:grid; gap:14px; padding:16px;}
#level-selection-screen .level-btn{width:100%; font-size:18px; padding:18px;}

.mm-modal{width:100%; max-width:none; border-radius:0;}
.mm-modal-header h2{font-size:26px;}
.mm-grid{grid-template-columns:repeat(5,minmax(0,1fr)); gap:10px;}
.mm-grid-btn{font-size:20px; padding:18px 0;}


/* Performance: reduz animações quando 'Reduzir Movimento' estiver ativo */
.reduce-motion .pet-spark{ animation:none !important; }
